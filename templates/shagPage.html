{% extends "base.html" %}
{% load static %}
{% block body %}
<section class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-16 lg:py-20">
  <div class="text-center mb-12 md:mb-16">
    <h2 class="text-3xl sm:text-4xl md:text-5xl font-bold text-primary tracking-tight">All Shags</h2>
    <div class="w-20 h-1 bg-primary mx-auto mt-6 rounded-full"></div>
  </div>

  <!-- Category Filter Bar -->
  <nav class="flex flex-wrap justify-center gap-2 sm:gap-3 md:gap-4 mb-10 md:mb-12" id="shag-categories">
    <button class="px-5 py-2.5 rounded-full text-sm font-medium transition-all duration-300 bg-primary text-white shadow-md hover:shadow-lg" data-category="all">All</button>
    {% for category in categories %}
      <button class="px-5 py-2.5 rounded-full text-sm font-medium transition-all duration-300 bg-white text-gray-700 border border-gray-200 hover:bg-primary hover:text-white hover:border-primary" data-category="{{ category.id }}">{{ category.name }}</button>
    {% endfor %}
  </nav>

  <main id="shag-products" class="grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5 md:gap-6 lg:gap-8">
    {% for product in shag_products %}
    <div class="bg-white rounded-xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-md transition-all duration-300 group">
      <div class="relative h-60 sm:h-64 bg-gray-50 flex items-center justify-center p-4 overflow-hidden">
        {% if product.image %}
        <img src="{{ product.image.url }}" alt="{{ product.name }}" class="max-h-44 object-contain transform group-hover:scale-105 transition-transform duration-500">
        {% else %}
        <img src="{% static 'images/bag1.jpg' %}" alt="{{ product.name }}" class="max-h-44 object-contain transform group-hover:scale-105 transition-transform duration-500">
        {% endif %}
        {% if product.badge %}
        <div class="absolute top-4 left-4 bg-primary text-white text-xs font-semibold px-3 py-1 rounded-full shadow-sm">{{ product.badge }}</div>
        {% endif %}
        <button class="absolute top-4 right-4 w-8 h-8 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-500 hover:text-red-500 transition-colors">
          <i class="far fa-eye text-lg"></i>
        </button>
      </div>
      <div class="p-4 md:p-5 flex flex-col gap-2">
        <h3 class="font-semibold text-gray-900 text-base md:text-lg line-clamp-1 hover:text-primary transition-colors">{{ product.name }}</h3>
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-2">
            <span class="text-primary font-bold text-lg md:text-xl">${{ product.price }}</span>
            {% if product.old_price %}
              <span class="text-gray-500 text-sm line-through">${{ product.old_price }}</span>
            {% endif %}
            {% if product.discount_percent %}
              <span class="text-green-600 text-xs font-medium bg-green-50 px-2 py-1 rounded-md">{{ product.discount_percent }}% off</span>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </main>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const categoryNav = document.getElementById('shag-categories');
      const productsGrid = document.getElementById('shag-products');
      if (categoryNav) {
        categoryNav.addEventListener('click', function(e) {
          if (e.target.tagName === 'BUTTON') {
            Array.from(categoryNav.querySelectorAll('button')).forEach(btn => {
              btn.classList.remove('bg-primary', 'text-white', 'shadow-md', 'hover:shadow-lg');
              btn.classList.add('bg-white', 'text-gray-700', 'border', 'border-gray-200');
            });
            e.target.classList.add('bg-primary', 'text-white', 'shadow-md', 'hover:shadow-lg');
            e.target.classList.remove('bg-white', 'text-gray-700', 'border', 'border-gray-200');

            const catId = e.target.getAttribute('data-category');
            if (catId === 'all') {
              fetch(`/products/category/0/?type=shag`)
                .then(res => res.json())
                .then(data => {
                  let html = '';
                  data.products.forEach(product => {
                    html += `
                    <div class=\"bg-white rounded-xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-md transition-all duration-300 group\">
                      <div class=\"relative h-60 sm:h-64 bg-gray-50 flex items-center justify-center p-4 overflow-hidden\">
                        <img src=\"${product.image || '{% static 'images/bag1.jpg' %}'}\" alt=\"${product.name}\" class=\"max-h-44 object-contain transform group-hover:scale-105 transition-transform duration-500\">
                        ${product.badge ? `<div class='absolute top-4 left-4 bg-primary text-white text-xs font-semibold px-3 py-1 rounded-full shadow-sm'>${product.badge}</div>` : ''}
                        <button class=\"absolute top-4 right-4 w-8 h-8 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-500 hover:text-red-500 transition-colors\">
                          <i class=\"far fa-eye text-lg\"></i>
                        </button>
                      </div>
                      <div class=\"p-4 md:p-5 flex flex-col gap-2\">
                        <h3 class=\"font-semibold text-gray-900 text-base md:text-lg line-clamp-1 hover:text-primary transition-colors\">${product.name}</h3>
                        <div class=\"flex items-center justify-between\">
                          <div class=\"flex items-center gap-2\">
                            <span class=\"text-primary font-bold text-lg md:text-xl\">$${product.price}</span>
                            ${product.old_price ? `<span class='text-gray-500 text-sm line-through'>$${product.old_price}</span>` : ''}
                            ${product.discount_percent ? `<span class='text-green-600 text-xs font-medium bg-green-50 px-2 py-1 rounded-md'>${product.discount_percent}% off</span>` : ''}
                          </div>
                        </div>
                      </div>
                    </div>
                    `;
                  });
                  productsGrid.innerHTML = html;
                });
              return;
            }
            fetch(`/products/category/${catId}/?type=shag`)
              .then(res => res.json())
              .then(data => {
                let html = '';
                data.products.forEach(product => {
                  html += `
                  <div class=\"bg-white rounded-xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-md transition-all duration-300 group\">
                    <div class=\"relative h-60 sm:h-64 bg-gray-50 flex items-center justify-center p-4 overflow-hidden\">
                      <img src=\"${product.image || '{% static 'images/bag1.jpg' %}'}\" alt=\"${product.name}\" class=\"max-h-44 object-contain transform group-hover:scale-105 transition-transform duration-500\">
                      ${product.badge ? `<div class='absolute top-4 left-4 bg-primary text-white text-xs font-semibold px-3 py-1 rounded-full shadow-sm'>${product.badge}</div>` : ''}
                      <button class=\"absolute top-4 right-4 w-8 h-8 rounded-full bg-white shadow-sm flex items-center justify-center text-gray-500 hover:text-red-500 transition-colors\">
                        <i class=\"far fa-eye text-lg\"></i>
                      </button>
                    </div>
                    <div class=\"p-4 md:p-5 flex flex-col gap-2\">
                      <h3 class=\"font-semibold text-gray-900 text-base md:text-lg line-clamp-1 hover:text-primary transition-colors\">${product.name}</h3>
                      <div class=\"flex items-center justify-between\">
                        <div class=\"flex items-center gap-2\">
                          <span class=\"text-primary font-bold text-lg md:text-xl\">$${product.price}</span>
                          ${product.old_price ? `<span class='text-gray-500 text-sm line-through'>$${product.old_price}</span>` : ''}
                          ${product.discount_percent ? `<span class='text-green-600 text-xs font-medium bg-green-50 px-2 py-1 rounded-md'>${product.discount_percent}% off</span>` : ''}
                        </div>
                      </div>
                    </div>
                  </div>
                  `;
                });
                productsGrid.innerHTML = html;
              });
          }
        });
      }
    });
  </script>
</section>
{% endblock %}
